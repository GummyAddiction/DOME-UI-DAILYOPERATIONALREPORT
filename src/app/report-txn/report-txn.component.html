<mat-form-field appearance="fill">
    <mat-label>Enter a date range</mat-label>
    <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
      <input matStartDate formControlName="start" placeholder="Start date">
      <input matEndDate formControlName="end" placeholder="End date">
    </mat-date-range-input>
    <mat-hint>MM/DD/YYYY â€“ MM/DD/YYYY</mat-hint>
    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-date-range-picker #picker></mat-date-range-picker>
    <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">Invalid start date</mat-error>
    <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">Invalid end date</mat-error>
  </mat-form-field>
  
  <p>Selected range: {{range.value | json}}</p>
  
<!--   
  <mat-form-field appearance="fill">
    <mat-label>Shift</mat-label>
    <mat-select (selectionChange)="shiftSelected($event.value)">
      <mat-option *ngFor="let shift of shifs" [value]="shift.value">
        {{shift.viewValue}}
      </mat-option>
    </mat-select>
  </mat-form-field>
   -->
  <button mat-flat-button color="primary" (click)="displayReportTxn()">Submit</button>
   
  <div class="mat-elevation-z8">
  <table mat-table [dataSource]="dataSource">
    <ng-container matColumnDef="reporttransactionid">
      <th mat-header-cell *matHeaderCellDef> Id </th>
      <td mat-cell *matCellDef="let element"> {{element.reporttransactionid}} </td>
    </ng-container>
  
    <ng-container matColumnDef="shift">
      <th mat-header-cell *matHeaderCellDef> shift </th>
      <td mat-cell *matCellDef="let element"> {{element.shift}} </td>
    </ng-container>
  
    <ng-container matColumnDef="datecreated">
      <th mat-header-cell *matHeaderCellDef> datecreated </th>
      <td mat-cell *matCellDef="let element"> {{element.datecreated}} </td>
    </ng-container>
  
    <ng-container matColumnDef="jobtype">
      <th mat-header-cell *matHeaderCellDef> jobtype </th>
      <td mat-cell *matCellDef="let element"> {{element.jobtype}} </td>
    </ng-container>
  
    <ng-container matColumnDef="timeinformed">
      <th mat-header-cell *matHeaderCellDef> timeinformed </th>
      <td mat-cell *matCellDef="let element"> {{element.timeinformed}} </td>
    </ng-container>
  
    <ng-container matColumnDef="starttime">
      <th mat-header-cell *matHeaderCellDef> starttime </th>
      <td mat-cell *matCellDef="let element"> {{element.starttime}} </td>
    </ng-container>
  
    <ng-container matColumnDef="finishtime">
      <th mat-header-cell *matHeaderCellDef> finishtime </th>
      <td mat-cell *matCellDef="let element"> {{element.finishtime}} </td>
    </ng-container>
  
    <ng-container matColumnDef="totaltime">
      <th mat-header-cell *matHeaderCellDef> totaltime </th>
      <td mat-cell *matCellDef="let element"> {{element.totaltime}} </td>
    </ng-container>
    <ng-container matColumnDef="stoppagetime">
        <th mat-header-cell *matHeaderCellDef> totaltime </th>
        <td mat-cell *matCellDef="let element"> {{element.stoppagetime}} </td>
      </ng-container>
  
    <ng-container matColumnDef="functionallocation">
      <th mat-header-cell *matHeaderCellDef> functionallocation </th>
      <td mat-cell *matCellDef="let element"> {{element.functionallocation}} </td>
    </ng-container>
  
    <ng-container matColumnDef="subfunctionallocation">
      <th mat-header-cell *matHeaderCellDef> subfunctionallocation </th>
      <td mat-cell *matCellDef="let element"> {{element.subfunctionallocation}} </td>
    </ng-container>
  
    <ng-container matColumnDef="machine">
      <th mat-header-cell *matHeaderCellDef> machine </th>
      <td mat-cell *matCellDef="let element"> {{element.machine}} </td>
    </ng-container>
  
    <ng-container matColumnDef="detailmachine">
      <th mat-header-cell *matHeaderCellDef> detailmachine </th>
      <td mat-cell *matCellDef="let element"> {{element.detailmachine}} </td>
    </ng-container>
  
    <ng-container matColumnDef="problem">
      <th mat-header-cell *matHeaderCellDef> problem </th>
      <td mat-cell *matCellDef="let element"> {{element.problem}} </td>
    </ng-container>
  
    <ng-container matColumnDef="cause">
      <th mat-header-cell *matHeaderCellDef> cause </th>
      <td mat-cell *matCellDef="let element"> {{element.cause}} </td>
    </ng-container>
  
    <ng-container matColumnDef="bias">
      <th mat-header-cell *matHeaderCellDef> bias </th>
      <td mat-cell *matCellDef="let element"> {{element.bias}} </td>
    </ng-container>
  
    <ng-container matColumnDef="action">
      <th mat-header-cell *matHeaderCellDef> action </th>
      <td mat-cell *matCellDef="let element"> {{element.action}} </td>
    </ng-container>
  
    <ng-container matColumnDef="executor1">
      <th mat-header-cell *matHeaderCellDef> executor1 </th>
      <td mat-cell *matCellDef="let element"> {{element.executor1}} </td>
    </ng-container>
  
    <ng-container matColumnDef="executor2">
      <th mat-header-cell *matHeaderCellDef> executor2 </th>
      <td mat-cell *matCellDef="let element"> {{element.executor2}} </td>
    </ng-container>
  
    <ng-container matColumnDef="executorextra">
      <th mat-header-cell *matHeaderCellDef> executorextra </th>
      <td mat-cell *matCellDef="let element"> {{element.executorextra}} </td>
    </ng-container>
  
    <ng-container matColumnDef="condition">
      <th mat-header-cell *matHeaderCellDef> condition </th>
      <td mat-cell *matCellDef="let element"> {{element.condition}} </td>
    </ng-container>
  
    <ng-container matColumnDef="reason">
      <th mat-header-cell *matHeaderCellDef> reason </th>
      <td mat-cell *matCellDef="let element"> {{element.reason}} </td>
    </ng-container>
  
    <ng-container matColumnDef="note">
      <th mat-header-cell *matHeaderCellDef> note </th>
      <td mat-cell *matCellDef="let element"> {{element.note}} </td>
    </ng-container>

    <ng-container matColumnDef="option">
      <th mat-header-cell *matHeaderCellDef>
        Option
      </th>
      <td mat-cell *matCellDef="let element">
        <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <button mat-menu-item>
            <span>Edit</span>
          </button>
          <button mat-menu-item (click)="openDialog(element.reporttransactionid)">
            <span>Delete</span>
          </button>
        </mat-menu>
      </td>
    </ng-container>
    
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

  <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                 showFirstLastButtons 
                 aria-label="Select page of periodic elements">
  </mat-paginator>
    
  </div>
  
  
  
  
  <!-- Test Excel export -->
  <div class="container">
  
    <h1>
      Excel Export
    </h1>
    <div class="card">
      <div class="card-header clearfix">
        <h5 class="pull-left">Txn Report</h5>
        <div class="pull-right">
          <button class="btn btn-success btn-sm" type="button" name="export" title="Export Data" (click)="exportExcel()">
            <i class="fa fa-file-excel-o"></i>&nbsp;Export Report
          </button>
        </div>
      </div>
  
     
  
  </div>


  <div>
    <ul *ngFor="let data of functionalLocation">
        <li>
            {{data.name}}
        </li>
    </ul>
  </div>



  <mat-form-field appearance="fill">
    <mat-label>Functional Location</mat-label>
    <mat-select [formControl]="functionalLocationForm" multiple > 
      <mat-option *ngFor="let data of functionalLocation" [value]="data">{{data.name}}</mat-option>
    </mat-select>
  </mat-form-field>

  

